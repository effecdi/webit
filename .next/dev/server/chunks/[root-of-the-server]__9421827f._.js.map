{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/upload/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { writeFile, mkdir } from 'fs/promises';\nimport path from 'path';\n\nconst ALLOWED_TYPES = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];\nconst MAX_SIZE = 10 * 1024 * 1024; // 10MB\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData();\n    const file = formData.get('file') as File;\n    \n    if (!file) {\n      return NextResponse.json({ error: 'No file provided' }, { status: 400 });\n    }\n\n    // Validate file type\n    if (!ALLOWED_TYPES.includes(file.type)) {\n      return NextResponse.json({ error: 'Invalid file type. Only JPEG, PNG, GIF, and WebP images are allowed.' }, { status: 400 });\n    }\n\n    // Validate file size\n    if (file.size > MAX_SIZE) {\n      return NextResponse.json({ error: 'File too large. Maximum size is 10MB.' }, { status: 400 });\n    }\n\n    const bytes = await file.arrayBuffer();\n    const buffer = Buffer.from(bytes);\n\n    const uploadDir = path.join(process.cwd(), 'public', 'uploads');\n    await mkdir(uploadDir, { recursive: true });\n\n    // Generate safe filename with extension based on MIME type\n    const ext = file.type.split('/')[1] === 'jpeg' ? 'jpg' : file.type.split('/')[1];\n    const uniqueName = `${Date.now()}-${Math.random().toString(36).slice(2)}.${ext}`;\n    const filePath = path.join(uploadDir, uniqueName);\n    \n    await writeFile(filePath, buffer);\n\n    const url = `/uploads/${uniqueName}`;\n    \n    return NextResponse.json({ url, filename: uniqueName });\n  } catch (error) {\n    console.error('Error uploading file:', error);\n    return NextResponse.json({ error: 'Failed to upload file' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,gBAAgB;IAAC;IAAc;IAAa;IAAa;CAAa;AAC5E,MAAM,WAAW,KAAK,OAAO,MAAM,OAAO;AAEnC,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;QACvC,MAAM,OAAO,SAAS,GAAG,CAAC;QAE1B,IAAI,CAAC,MAAM;YACT,OAAO,gRAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,qBAAqB;QACrB,IAAI,CAAC,cAAc,QAAQ,CAAC,KAAK,IAAI,GAAG;YACtC,OAAO,gRAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAuE,GAAG;gBAAE,QAAQ;YAAI;QAC5H;QAEA,qBAAqB;QACrB,IAAI,KAAK,IAAI,GAAG,UAAU;YACxB,OAAO,gRAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwC,GAAG;gBAAE,QAAQ;YAAI;QAC7F;QAEA,MAAM,QAAQ,MAAM,KAAK,WAAW;QACpC,MAAM,SAAS,OAAO,IAAI,CAAC;QAE3B,MAAM,YAAY,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,UAAU;QACrD,MAAM,IAAA,8HAAK,EAAC,WAAW;YAAE,WAAW;QAAK;QAEzC,2DAA2D;QAC3D,MAAM,MAAM,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,KAAK,SAAS,QAAQ,KAAK,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;QAChF,MAAM,aAAa,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,KAAK,CAAC,GAAG,CAAC,EAAE,KAAK;QAChF,MAAM,WAAW,4GAAI,CAAC,IAAI,CAAC,WAAW;QAEtC,MAAM,IAAA,kIAAS,EAAC,UAAU;QAE1B,MAAM,MAAM,CAAC,SAAS,EAAE,YAAY;QAEpC,OAAO,gRAAY,CAAC,IAAI,CAAC;YAAE;YAAK,UAAU;QAAW;IACvD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gRAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF"}}]
}