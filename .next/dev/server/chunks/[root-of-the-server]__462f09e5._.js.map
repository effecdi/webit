{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/db/schema.ts"],"sourcesContent":["import { pgTable, serial, text, varchar, boolean, timestamp, numeric, jsonb, integer } from 'drizzle-orm/pg-core';\nimport { sql } from 'drizzle-orm';\n\nexport const users = pgTable('users', {\n  id: varchar('id').primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar('email'),\n  firstName: varchar('first_name'),\n  lastName: varchar('last_name'),\n  profileImageUrl: varchar('profile_image_url'),\n  provider: varchar('provider').default('replit'),\n  providerId: varchar('provider_id'),\n  stripeCustomerId: varchar('stripe_customer_id'),\n  stripeSubscriptionId: varchar('stripe_subscription_id'),\n  subscriptionPlan: varchar('subscription_plan').default('free'),\n  subscriptionStatus: varchar('subscription_status').default('inactive'),\n  createdAt: timestamp('created_at').defaultNow(),\n  updatedAt: timestamp('updated_at').defaultNow(),\n});\n\nexport const profiles = pgTable('profiles', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  username: text('username'),\n  partnerName: text('partner_name'),\n  firstMeetDate: timestamp('first_meet_date'),\n  coupleIntro: text('couple_intro'),\n  isMembershipActive: boolean('is_membership_active').default(false),\n  membershipTier: text('membership_tier').default('free'),\n  currentMode: text('current_mode').default('love'),\n  myMood: text('my_mood').default('heart'),\n  partnerMood: text('partner_mood').default('heart'),\n  stripeCustomerId: varchar('stripe_customer_id'),\n  stripeSubscriptionId: varchar('stripe_subscription_id'),\n  subscriptionPlan: varchar('subscription_plan').default('free'),\n  subscriptionStatus: varchar('subscription_status').default('inactive'),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const events = pgTable('events', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  title: text('title').notNull(),\n  description: text('description'),\n  date: timestamp('date').notNull(),\n  time: text('time'),\n  location: text('location'),\n  category: text('category'),\n  mode: text('mode').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const todos = pgTable('todos', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  text: text('text').notNull(),\n  completed: boolean('completed').default(false),\n  assignee: text('assignee').default('we'),\n  mode: text('mode').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const todoComments = pgTable('todo_comments', {\n  id: serial('id').primaryKey(),\n  todoId: integer('todo_id').notNull(),\n  author: text('author').notNull(),\n  text: text('text').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const photos = pgTable('photos', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  url: text('url').notNull(),\n  caption: text('caption'),\n  albumId: integer('album_id'),\n  liked: boolean('liked').default(false),\n  mode: text('mode').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const albums = pgTable('albums', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  title: text('title').notNull(),\n  thumbnail: text('thumbnail'),\n  eventDate: timestamp('event_date'),\n  mode: text('mode').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const notifications = pgTable('notifications', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  type: text('type').notNull(),\n  title: text('title').notNull(),\n  message: text('message').notNull(),\n  isRead: boolean('is_read').default(false),\n  mode: text('mode').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const expenses = pgTable('expenses', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  title: text('title').notNull(),\n  amount: numeric('amount').notNull(),\n  category: text('category').notNull(),\n  isPaid: boolean('is_paid').default(false),\n  memo: text('memo'),\n  date: timestamp('date').notNull(),\n  mode: text('mode').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const checklistItems = pgTable('checklist_items', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  category: text('category').notNull(),\n  title: text('title').notNull(),\n  completed: boolean('completed').default(false),\n  dueDate: timestamp('due_date'),\n  priority: text('priority').default('medium'),\n  mode: text('mode').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const travels = pgTable('travels', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  title: text('title').notNull(),\n  destination: text('destination').notNull(),\n  startDate: timestamp('start_date').notNull(),\n  endDate: timestamp('end_date').notNull(),\n  thumbnail: text('thumbnail'),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const travelSchedules = pgTable('travel_schedules', {\n  id: serial('id').primaryKey(),\n  travelId: integer('travel_id').notNull(),\n  day: integer('day').notNull(),\n  time: text('time'),\n  title: text('title').notNull(),\n  location: text('location'),\n  memo: text('memo'),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const widgets = pgTable('widgets', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  type: text('type').notNull(),\n  isEnabled: boolean('is_enabled').default(true),\n  settings: text('settings'),\n});\n\nexport const weddingInfo = pgTable('wedding_info', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  weddingDate: text('wedding_date'),\n  weddingTime: text('wedding_time'),\n  venue: text('venue'),\n  expectedGuests: integer('expected_guests'),\n  groomGuests: integer('groom_guests').default(0),\n  brideGuests: integer('bride_guests').default(0),\n  mealCostAdult: integer('meal_cost_adult').default(0),\n  mealCostChild: integer('meal_cost_child').default(0),\n  invitationCount: integer('invitation_count').default(0),\n  physicalInvitationCount: integer('physical_invitation_count').default(0),\n  invitationData: jsonb('invitation_data'),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const guests = pgTable('guests', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  name: text('name').notNull(),\n  side: text('side').notNull(),\n  relationship: text('relationship'),\n  attendance: text('attendance').default('pending'),\n  invitationSent: boolean('invitation_sent').default(false),\n  mealType: text('meal_type').default('adult'),\n  giftAmount: integer('gift_amount').default(0),\n  memo: text('memo'),\n  phone: text('phone'),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const invitations = pgTable('invitations', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  templateId: text('template_id').notNull(),\n  title: text('title'),\n  shareId: text('share_id').unique(),\n  invitationData: jsonb('invitation_data'),\n  createdAt: timestamp('created_at').defaultNow(),\n  updatedAt: timestamp('updated_at').defaultNow(),\n});\n\nexport const communityPosts = pgTable('community_posts', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  mode: text('mode').notNull(),\n  category: text('category').notNull(),\n  title: text('title').notNull(),\n  content: text('content').notNull(),\n  authorName: text('author_name'),\n  likeCount: integer('like_count').default(0),\n  commentCount: integer('comment_count').default(0),\n  viewCount: integer('view_count').default(0),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const communityComments = pgTable('community_comments', {\n  id: serial('id').primaryKey(),\n  postId: integer('post_id').notNull(),\n  userId: text('user_id').notNull(),\n  content: text('content').notNull(),\n  authorName: text('author_name'),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const communityLikes = pgTable('community_likes', {\n  id: serial('id').primaryKey(),\n  postId: integer('post_id').notNull(),\n  userId: text('user_id').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const couples = pgTable('couples', {\n  id: serial('id').primaryKey(),\n  user1Id: text('user1_id').notNull(),\n  user2Id: text('user2_id').notNull(),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const coupleInvites = pgTable('couple_invites', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull(),\n  inviteCode: varchar('invite_code').notNull().unique(),\n  inviterName: text('inviter_name'),\n  mode: text('mode').notNull(),\n  status: text('status').default('pending'),\n  createdAt: timestamp('created_at').defaultNow(),\n});\n\nexport const sessions = pgTable('sessions', {\n  sid: varchar('sid').primaryKey(),\n  sess: jsonb('sess').notNull(),\n  expire: timestamp('expire').notNull(),\n});\n\nexport const userSettings = pgTable('user_settings', {\n  id: serial('id').primaryKey(),\n  userId: text('user_id').notNull().unique(),\n  notifMessage: boolean('notif_message').default(true),\n  notifSchedule: boolean('notif_schedule').default(true),\n  notifAnniversary: boolean('notif_anniversary').default(true),\n  notifGift: boolean('notif_gift').default(false),\n  notifDaily: boolean('notif_daily').default(false),\n  privacyProfileVisible: boolean('privacy_profile_visible').default(true),\n  privacyLocationShare: boolean('privacy_location_share').default(false),\n  privacyReadReceipt: boolean('privacy_read_receipt').default(true),\n  privacyOnlineStatus: boolean('privacy_online_status').default(true),\n  privacyActivityShare: boolean('privacy_activity_share').default(false),\n  supportNewsletter: boolean('support_newsletter').default(true),\n  supportEventNotify: boolean('support_event_notify').default(true),\n  supportFeedback: boolean('support_feedback').default(false),\n  supportSurvey: boolean('support_survey').default(false),\n  updatedAt: timestamp('updated_at').defaultNow(),\n});\n\nexport type User = typeof users.$inferSelect;\nexport type Profile = typeof profiles.$inferSelect;\nexport type Event = typeof events.$inferSelect;\nexport type Todo = typeof todos.$inferSelect;\nexport type TodoComment = typeof todoComments.$inferSelect;\nexport type Photo = typeof photos.$inferSelect;\nexport type Album = typeof albums.$inferSelect;\nexport type Notification = typeof notifications.$inferSelect;\nexport type Expense = typeof expenses.$inferSelect;\nexport type ChecklistItem = typeof checklistItems.$inferSelect;\nexport type Travel = typeof travels.$inferSelect;\nexport type TravelSchedule = typeof travelSchedules.$inferSelect;\nexport type Widget = typeof widgets.$inferSelect;\nexport type WeddingInfo = typeof weddingInfo.$inferSelect;\nexport type Guest = typeof guests.$inferSelect;\nexport type Invitation = typeof invitations.$inferSelect;\nexport type CommunityPost = typeof communityPosts.$inferSelect;\nexport type CommunityComment = typeof communityComments.$inferSelect;\nexport type CommunityLike = typeof communityLikes.$inferSelect;\nexport type Couple = typeof couples.$inferSelect;\nexport type CoupleInvite = typeof coupleInvites.$inferSelect;\nexport type UserSettings = typeof userSettings.$inferSelect;\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAEO,MAAM,QAAQ,IAAA,kKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,+KAAO,EAAC,MAAM,UAAU,GAAG,OAAO,CAAC,qJAAG,CAAC,iBAAiB,CAAC;IAC7D,OAAO,IAAA,+KAAO,EAAC;IACf,WAAW,IAAA,+KAAO,EAAC;IACnB,UAAU,IAAA,+KAAO,EAAC;IAClB,iBAAiB,IAAA,+KAAO,EAAC;IACzB,UAAU,IAAA,+KAAO,EAAC,YAAY,OAAO,CAAC;IACtC,YAAY,IAAA,+KAAO,EAAC;IACpB,kBAAkB,IAAA,+KAAO,EAAC;IAC1B,sBAAsB,IAAA,+KAAO,EAAC;IAC9B,kBAAkB,IAAA,+KAAO,EAAC,qBAAqB,OAAO,CAAC;IACvD,oBAAoB,IAAA,+KAAO,EAAC,uBAAuB,OAAO,CAAC;IAC3D,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;IAC7C,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,WAAW,IAAA,kKAAO,EAAC,YAAY;IAC1C,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,UAAU,IAAA,yKAAI,EAAC;IACf,aAAa,IAAA,yKAAI,EAAC;IAClB,eAAe,IAAA,mLAAS,EAAC;IACzB,aAAa,IAAA,yKAAI,EAAC;IAClB,oBAAoB,IAAA,+KAAO,EAAC,wBAAwB,OAAO,CAAC;IAC5D,gBAAgB,IAAA,yKAAI,EAAC,mBAAmB,OAAO,CAAC;IAChD,aAAa,IAAA,yKAAI,EAAC,gBAAgB,OAAO,CAAC;IAC1C,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO,CAAC;IAChC,aAAa,IAAA,yKAAI,EAAC,gBAAgB,OAAO,CAAC;IAC1C,kBAAkB,IAAA,+KAAO,EAAC;IAC1B,sBAAsB,IAAA,+KAAO,EAAC;IAC9B,kBAAkB,IAAA,+KAAO,EAAC,qBAAqB,OAAO,CAAC;IACvD,oBAAoB,IAAA,+KAAO,EAAC,uBAAuB,OAAO,CAAC;IAC3D,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,SAAS,IAAA,kKAAO,EAAC,UAAU;IACtC,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,aAAa,IAAA,yKAAI,EAAC;IAClB,MAAM,IAAA,mLAAS,EAAC,QAAQ,OAAO;IAC/B,MAAM,IAAA,yKAAI,EAAC;IACX,UAAU,IAAA,yKAAI,EAAC;IACf,UAAU,IAAA,yKAAI,EAAC;IACf,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,QAAQ,IAAA,kKAAO,EAAC,SAAS;IACpC,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,+KAAO,EAAC,aAAa,OAAO,CAAC;IACxC,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO,CAAC;IACnC,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,eAAe,IAAA,kKAAO,EAAC,iBAAiB;IACnD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,+KAAO,EAAC,WAAW,OAAO;IAClC,QAAQ,IAAA,yKAAI,EAAC,UAAU,OAAO;IAC9B,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,SAAS,IAAA,kKAAO,EAAC,UAAU;IACtC,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,KAAK,IAAA,yKAAI,EAAC,OAAO,OAAO;IACxB,SAAS,IAAA,yKAAI,EAAC;IACd,SAAS,IAAA,+KAAO,EAAC;IACjB,OAAO,IAAA,+KAAO,EAAC,SAAS,OAAO,CAAC;IAChC,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,SAAS,IAAA,kKAAO,EAAC,UAAU;IACtC,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,WAAW,IAAA,yKAAI,EAAC;IAChB,WAAW,IAAA,mLAAS,EAAC;IACrB,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,gBAAgB,IAAA,kKAAO,EAAC,iBAAiB;IACpD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,SAAS,IAAA,yKAAI,EAAC,WAAW,OAAO;IAChC,QAAQ,IAAA,+KAAO,EAAC,WAAW,OAAO,CAAC;IACnC,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,WAAW,IAAA,kKAAO,EAAC,YAAY;IAC1C,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,QAAQ,IAAA,+KAAO,EAAC,UAAU,OAAO;IACjC,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO;IAClC,QAAQ,IAAA,+KAAO,EAAC,WAAW,OAAO,CAAC;IACnC,MAAM,IAAA,yKAAI,EAAC;IACX,MAAM,IAAA,mLAAS,EAAC,QAAQ,OAAO;IAC/B,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,iBAAiB,IAAA,kKAAO,EAAC,mBAAmB;IACvD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO;IAClC,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,WAAW,IAAA,+KAAO,EAAC,aAAa,OAAO,CAAC;IACxC,SAAS,IAAA,mLAAS,EAAC;IACnB,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO,CAAC;IACnC,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,UAAU,IAAA,kKAAO,EAAC,WAAW;IACxC,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,aAAa,IAAA,yKAAI,EAAC,eAAe,OAAO;IACxC,WAAW,IAAA,mLAAS,EAAC,cAAc,OAAO;IAC1C,SAAS,IAAA,mLAAS,EAAC,YAAY,OAAO;IACtC,WAAW,IAAA,yKAAI,EAAC;IAChB,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,kBAAkB,IAAA,kKAAO,EAAC,oBAAoB;IACzD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,UAAU,IAAA,+KAAO,EAAC,aAAa,OAAO;IACtC,KAAK,IAAA,+KAAO,EAAC,OAAO,OAAO;IAC3B,MAAM,IAAA,yKAAI,EAAC;IACX,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,UAAU,IAAA,yKAAI,EAAC;IACf,MAAM,IAAA,yKAAI,EAAC;IACX,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,UAAU,IAAA,kKAAO,EAAC,WAAW;IACxC,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,WAAW,IAAA,+KAAO,EAAC,cAAc,OAAO,CAAC;IACzC,UAAU,IAAA,yKAAI,EAAC;AACjB;AAEO,MAAM,cAAc,IAAA,kKAAO,EAAC,gBAAgB;IACjD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,aAAa,IAAA,yKAAI,EAAC;IAClB,aAAa,IAAA,yKAAI,EAAC;IAClB,OAAO,IAAA,yKAAI,EAAC;IACZ,gBAAgB,IAAA,+KAAO,EAAC;IACxB,aAAa,IAAA,+KAAO,EAAC,gBAAgB,OAAO,CAAC;IAC7C,aAAa,IAAA,+KAAO,EAAC,gBAAgB,OAAO,CAAC;IAC7C,eAAe,IAAA,+KAAO,EAAC,mBAAmB,OAAO,CAAC;IAClD,eAAe,IAAA,+KAAO,EAAC,mBAAmB,OAAO,CAAC;IAClD,iBAAiB,IAAA,+KAAO,EAAC,oBAAoB,OAAO,CAAC;IACrD,yBAAyB,IAAA,+KAAO,EAAC,6BAA6B,OAAO,CAAC;IACtE,gBAAgB,IAAA,2KAAK,EAAC;IACtB,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,SAAS,IAAA,kKAAO,EAAC,UAAU;IACtC,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,cAAc,IAAA,yKAAI,EAAC;IACnB,YAAY,IAAA,yKAAI,EAAC,cAAc,OAAO,CAAC;IACvC,gBAAgB,IAAA,+KAAO,EAAC,mBAAmB,OAAO,CAAC;IACnD,UAAU,IAAA,yKAAI,EAAC,aAAa,OAAO,CAAC;IACpC,YAAY,IAAA,+KAAO,EAAC,eAAe,OAAO,CAAC;IAC3C,MAAM,IAAA,yKAAI,EAAC;IACX,OAAO,IAAA,yKAAI,EAAC;IACZ,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,cAAc,IAAA,kKAAO,EAAC,eAAe;IAChD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,YAAY,IAAA,yKAAI,EAAC,eAAe,OAAO;IACvC,OAAO,IAAA,yKAAI,EAAC;IACZ,SAAS,IAAA,yKAAI,EAAC,YAAY,MAAM;IAChC,gBAAgB,IAAA,2KAAK,EAAC;IACtB,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;IAC7C,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,iBAAiB,IAAA,kKAAO,EAAC,mBAAmB;IACvD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,UAAU,IAAA,yKAAI,EAAC,YAAY,OAAO;IAClC,OAAO,IAAA,yKAAI,EAAC,SAAS,OAAO;IAC5B,SAAS,IAAA,yKAAI,EAAC,WAAW,OAAO;IAChC,YAAY,IAAA,yKAAI,EAAC;IACjB,WAAW,IAAA,+KAAO,EAAC,cAAc,OAAO,CAAC;IACzC,cAAc,IAAA,+KAAO,EAAC,iBAAiB,OAAO,CAAC;IAC/C,WAAW,IAAA,+KAAO,EAAC,cAAc,OAAO,CAAC;IACzC,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,oBAAoB,IAAA,kKAAO,EAAC,sBAAsB;IAC7D,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,+KAAO,EAAC,WAAW,OAAO;IAClC,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,SAAS,IAAA,yKAAI,EAAC,WAAW,OAAO;IAChC,YAAY,IAAA,yKAAI,EAAC;IACjB,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,iBAAiB,IAAA,kKAAO,EAAC,mBAAmB;IACvD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,+KAAO,EAAC,WAAW,OAAO;IAClC,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,UAAU,IAAA,kKAAO,EAAC,WAAW;IACxC,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,SAAS,IAAA,yKAAI,EAAC,YAAY,OAAO;IACjC,SAAS,IAAA,yKAAI,EAAC,YAAY,OAAO;IACjC,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,gBAAgB,IAAA,kKAAO,EAAC,kBAAkB;IACrD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO;IAC/B,YAAY,IAAA,+KAAO,EAAC,eAAe,OAAO,GAAG,MAAM;IACnD,aAAa,IAAA,yKAAI,EAAC;IAClB,MAAM,IAAA,yKAAI,EAAC,QAAQ,OAAO;IAC1B,QAAQ,IAAA,yKAAI,EAAC,UAAU,OAAO,CAAC;IAC/B,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C;AAEO,MAAM,WAAW,IAAA,kKAAO,EAAC,YAAY;IAC1C,KAAK,IAAA,+KAAO,EAAC,OAAO,UAAU;IAC9B,MAAM,IAAA,2KAAK,EAAC,QAAQ,OAAO;IAC3B,QAAQ,IAAA,mLAAS,EAAC,UAAU,OAAO;AACrC;AAEO,MAAM,eAAe,IAAA,kKAAO,EAAC,iBAAiB;IACnD,IAAI,IAAA,6KAAM,EAAC,MAAM,UAAU;IAC3B,QAAQ,IAAA,yKAAI,EAAC,WAAW,OAAO,GAAG,MAAM;IACxC,cAAc,IAAA,+KAAO,EAAC,iBAAiB,OAAO,CAAC;IAC/C,eAAe,IAAA,+KAAO,EAAC,kBAAkB,OAAO,CAAC;IACjD,kBAAkB,IAAA,+KAAO,EAAC,qBAAqB,OAAO,CAAC;IACvD,WAAW,IAAA,+KAAO,EAAC,cAAc,OAAO,CAAC;IACzC,YAAY,IAAA,+KAAO,EAAC,eAAe,OAAO,CAAC;IAC3C,uBAAuB,IAAA,+KAAO,EAAC,2BAA2B,OAAO,CAAC;IAClE,sBAAsB,IAAA,+KAAO,EAAC,0BAA0B,OAAO,CAAC;IAChE,oBAAoB,IAAA,+KAAO,EAAC,wBAAwB,OAAO,CAAC;IAC5D,qBAAqB,IAAA,+KAAO,EAAC,yBAAyB,OAAO,CAAC;IAC9D,sBAAsB,IAAA,+KAAO,EAAC,0BAA0B,OAAO,CAAC;IAChE,mBAAmB,IAAA,+KAAO,EAAC,sBAAsB,OAAO,CAAC;IACzD,oBAAoB,IAAA,+KAAO,EAAC,wBAAwB,OAAO,CAAC;IAC5D,iBAAiB,IAAA,+KAAO,EAAC,oBAAoB,OAAO,CAAC;IACrD,eAAe,IAAA,+KAAO,EAAC,kBAAkB,OAAO,CAAC;IACjD,WAAW,IAAA,mLAAS,EAAC,cAAc,UAAU;AAC/C"}},
    {"offset": {"line": 368, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/db/index.ts"],"sourcesContent":["import { drizzle } from 'drizzle-orm/node-postgres';\nimport pg from 'pg';\nimport * as schema from './schema';\n\nconst { Pool } = pg;\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n});\n\nexport const db = drizzle(pool, { schema });\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,EAAE,IAAI,EAAE,GAAG,+GAAE;AAEnB,MAAM,OAAO,IAAI,KAAK;IACpB,kBAAkB,QAAQ,GAAG,CAAC,YAAY;AAC5C;AAEO,MAAM,KAAK,IAAA,yKAAO,EAAC,MAAM;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 397, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/lib/couple-utils.ts"],"sourcesContent":["import { db } from \"@/db\";\nimport { couples } from \"@/db/schema\";\nimport { eq, or } from \"drizzle-orm\";\n\nexport async function getCoupleUserIds(userId: string): Promise<string[]> {\n  try {\n    const [couple] = await db\n      .select()\n      .from(couples)\n      .where(or(eq(couples.user1Id, userId), eq(couples.user2Id, userId)));\n\n    if (!couple) return [userId];\n\n    return [couple.user1Id, couple.user2Id];\n  } catch {\n    return [userId];\n  }\n}\n\nexport async function getPartnerId(userId: string): Promise<string | null> {\n  try {\n    const [couple] = await db\n      .select()\n      .from(couples)\n      .where(or(eq(couples.user1Id, userId), eq(couples.user2Id, userId)));\n\n    if (!couple) return null;\n\n    return couple.user1Id === userId ? couple.user2Id : couple.user1Id;\n  } catch {\n    return null;\n  }\n}\n\nexport async function getCoupleRecord(userId: string) {\n  try {\n    const [couple] = await db\n      .select()\n      .from(couples)\n      .where(or(eq(couples.user1Id, userId), eq(couples.user2Id, userId)));\n\n    return couple || null;\n  } catch {\n    return null;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;;;;;;;;AAEO,eAAe,iBAAiB,MAAc;IACnD,IAAI;QACF,MAAM,CAAC,OAAO,GAAG,MAAM,mHAAE,CACtB,MAAM,GACN,IAAI,CAAC,yHAAO,EACZ,KAAK,CAAC,IAAA,0KAAE,EAAC,IAAA,0KAAE,EAAC,yHAAO,CAAC,OAAO,EAAE,SAAS,IAAA,0KAAE,EAAC,yHAAO,CAAC,OAAO,EAAE;QAE7D,IAAI,CAAC,QAAQ,OAAO;YAAC;SAAO;QAE5B,OAAO;YAAC,OAAO,OAAO;YAAE,OAAO,OAAO;SAAC;IACzC,EAAE,OAAM;QACN,OAAO;YAAC;SAAO;IACjB;AACF;AAEO,eAAe,aAAa,MAAc;IAC/C,IAAI;QACF,MAAM,CAAC,OAAO,GAAG,MAAM,mHAAE,CACtB,MAAM,GACN,IAAI,CAAC,yHAAO,EACZ,KAAK,CAAC,IAAA,0KAAE,EAAC,IAAA,0KAAE,EAAC,yHAAO,CAAC,OAAO,EAAE,SAAS,IAAA,0KAAE,EAAC,yHAAO,CAAC,OAAO,EAAE;QAE7D,IAAI,CAAC,QAAQ,OAAO;QAEpB,OAAO,OAAO,OAAO,KAAK,SAAS,OAAO,OAAO,GAAG,OAAO,OAAO;IACpE,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe,gBAAgB,MAAc;IAClD,IAAI;QACF,MAAM,CAAC,OAAO,GAAG,MAAM,mHAAE,CACtB,MAAM,GACN,IAAI,CAAC,yHAAO,EACZ,KAAK,CAAC,IAAA,0KAAE,EAAC,IAAA,0KAAE,EAAC,yHAAO,CAAC,OAAO,EAAE,SAAS,IAAA,0KAAE,EAAC,yHAAO,CAAC,OAAO,EAAE;QAE7D,OAAO,UAAU;IACnB,EAAE,OAAM;QACN,OAAO;IACT;AACF"}},
    {"offset": {"line": 455, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/app/api/invitation/guestbook/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { db } from '@/db';\nimport { weddingInfo } from '@/db/schema';\nimport { eq, inArray } from 'drizzle-orm';\nimport { getCoupleUserIds } from '@/lib/couple-utils';\n\nexport async function GET(request: NextRequest) {\n  const searchParams = request.nextUrl.searchParams;\n  const userId = searchParams.get('userId') || 'default';\n  const coupleUserIds = await getCoupleUserIds(userId);\n\n  try {\n    const result = await db.select().from(weddingInfo)\n      .where(inArray(weddingInfo.userId, coupleUserIds))\n      .limit(1);\n\n    if (result.length === 0 || !result[0].invitationData) {\n      return NextResponse.json([]);\n    }\n\n    const data = result[0].invitationData as Record<string, unknown>;\n    return NextResponse.json(data.guestbookEntries || []);\n  } catch (error) {\n    console.error('Error fetching guestbook:', error);\n    return NextResponse.json([]);\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { userId = 'default', entry } = body;\n    const coupleUserIds = await getCoupleUserIds(userId);\n\n    const result = await db.select().from(weddingInfo)\n      .where(inArray(weddingInfo.userId, coupleUserIds))\n      .limit(1);\n\n    if (result.length === 0) {\n      return NextResponse.json({ error: 'No invitation found' }, { status: 404 });\n    }\n\n    const currentData = (result[0].invitationData as Record<string, unknown>) || {};\n    const entries = Array.isArray(currentData.guestbookEntries) ? currentData.guestbookEntries : [];\n    entries.unshift(entry);\n\n    await db.update(weddingInfo)\n      .set({\n        invitationData: { ...currentData, guestbookEntries: entries },\n      })\n      .where(eq(weddingInfo.id, result[0].id));\n\n    return NextResponse.json({ success: true });\n  } catch (error) {\n    console.error('Error saving guestbook entry:', error);\n    return NextResponse.json({ error: 'Failed to save entry' }, { status: 500 });\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;IACjD,MAAM,SAAS,aAAa,GAAG,CAAC,aAAa;IAC7C,MAAM,gBAAgB,MAAM,IAAA,4IAAgB,EAAC;IAE7C,IAAI;QACF,MAAM,SAAS,MAAM,mHAAE,CAAC,MAAM,GAAG,IAAI,CAAC,6HAAW,EAC9C,KAAK,CAAC,IAAA,+KAAO,EAAC,6HAAW,CAAC,MAAM,EAAE,gBAClC,KAAK,CAAC;QAET,IAAI,OAAO,MAAM,KAAK,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,cAAc,EAAE;YACpD,OAAO,gRAAY,CAAC,IAAI,CAAC,EAAE;QAC7B;QAEA,MAAM,OAAO,MAAM,CAAC,EAAE,CAAC,cAAc;QACrC,OAAO,gRAAY,CAAC,IAAI,CAAC,KAAK,gBAAgB,IAAI,EAAE;IACtD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gRAAY,CAAC,IAAI,CAAC,EAAE;IAC7B;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,SAAS,SAAS,EAAE,KAAK,EAAE,GAAG;QACtC,MAAM,gBAAgB,MAAM,IAAA,4IAAgB,EAAC;QAE7C,MAAM,SAAS,MAAM,mHAAE,CAAC,MAAM,GAAG,IAAI,CAAC,6HAAW,EAC9C,KAAK,CAAC,IAAA,+KAAO,EAAC,6HAAW,CAAC,MAAM,EAAE,gBAClC,KAAK,CAAC;QAET,IAAI,OAAO,MAAM,KAAK,GAAG;YACvB,OAAO,gRAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,MAAM,cAAc,AAAC,MAAM,CAAC,EAAE,CAAC,cAAc,IAAgC,CAAC;QAC9E,MAAM,UAAU,MAAM,OAAO,CAAC,YAAY,gBAAgB,IAAI,YAAY,gBAAgB,GAAG,EAAE;QAC/F,QAAQ,OAAO,CAAC;QAEhB,MAAM,mHAAE,CAAC,MAAM,CAAC,6HAAW,EACxB,GAAG,CAAC;YACH,gBAAgB;gBAAE,GAAG,WAAW;gBAAE,kBAAkB;YAAQ;QAC9D,GACC,KAAK,CAAC,IAAA,0KAAE,EAAC,6HAAW,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,CAAC,EAAE;QAExC,OAAO,gRAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC3C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,gRAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF"}}]
}