{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/workspace/components/invitation-layouts/use-preview-state.ts"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useRef, useCallback } from \"react\"\nimport type { InvitationData } from \"@/app/wedding/editor/page\"\nimport type { PreviewState, PreviewHelpers, GuestbookEntry } from \"./types\"\n\nexport function usePreviewState(data: InvitationData & { date?: string; time?: string }) {\n  const allPhotos = [data.coverImage, ...(data.mainPhotos || [])].filter(Boolean) as string[]\n  const galleryImages = data.galleryImages?.filter(Boolean) || []\n\n  const [currentSlide, setCurrentSlide] = useState(0)\n  const [showContact, setShowContact] = useState(false)\n  const [showPhotoViewer, setShowPhotoViewer] = useState(false)\n  const [viewerIndex, setViewerIndex] = useState(0)\n  const [showGuestbookForm, setShowGuestbookForm] = useState(false)\n  const [guestbookName, setGuestbookName] = useState(\"\")\n  const [guestbookMessage, setGuestbookMessage] = useState(\"\")\n  const [guestbookEntries, setGuestbookEntries] = useState<GuestbookEntry[]>([])\n  const [copiedToast, setCopiedToast] = useState(\"\")\n  const [countdown, setCountdown] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0 })\n  const [expandedAccordion, setExpandedAccordion] = useState<string | null>(null)\n  const slideInterval = useRef<NodeJS.Timeout | null>(null)\n\n  const coverStyle = data.coverDisplayStyle || \"slide\"\n\n  useEffect(() => {\n    if (allPhotos.length <= 1 || coverStyle === \"static\") return\n    slideInterval.current = setInterval(() => {\n      setCurrentSlide((prev) => (prev + 1) % allPhotos.length)\n    }, 3000)\n    return () => {\n      if (slideInterval.current) clearInterval(slideInterval.current)\n    }\n  }, [allPhotos.length, coverStyle])\n\n  useEffect(() => {\n    if (!data.weddingDate) return\n    const updateCountdown = () => {\n      const now = new Date().getTime()\n      const target = new Date(data.weddingDate!).getTime()\n      const diff = Math.max(0, target - now)\n      setCountdown({\n        days: Math.floor(diff / (1000 * 60 * 60 * 24)),\n        hours: Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)),\n        minutes: Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)),\n        seconds: Math.floor((diff % (1000 * 60)) / 1000),\n      })\n    }\n    updateCountdown()\n    const timer = setInterval(updateCountdown, 1000)\n    return () => clearInterval(timer)\n  }, [data.weddingDate])\n\n  useEffect(() => {\n    const loadGuestbook = async () => {\n      try {\n        const res = await fetch(\"/api/invitation/guestbook?userId=default\")\n        if (res.ok) {\n          const entries = await res.json()\n          if (Array.isArray(entries)) setGuestbookEntries(entries)\n        }\n      } catch {}\n    }\n    loadGuestbook()\n  }, [])\n\n  const copyToClipboard = useCallback((text: string, label: string) => {\n    navigator.clipboard.writeText(text).then(() => {\n      setCopiedToast(`${label} 복사되었습니다.`)\n      setTimeout(() => setCopiedToast(\"\"), 2000)\n    }).catch(() => {})\n  }, [])\n\n  const copyLink = useCallback(() => {\n    const url = window.location.origin + \"/invitation/preview\"\n    navigator.clipboard.writeText(url).then(() => {\n      setCopiedToast(\"링크가 복사되었습니다.\")\n      setTimeout(() => setCopiedToast(\"\"), 2000)\n    }).catch(() => {})\n  }, [])\n\n  const submitGuestbook = useCallback(async () => {\n    if (!guestbookName.trim() || !guestbookMessage.trim()) return\n    const entry = {\n      name: guestbookName.trim(),\n      message: guestbookMessage.trim(),\n      date: new Date().toISOString().split(\"T\")[0],\n    }\n    try {\n      await fetch(\"/api/invitation/guestbook\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ userId: \"default\", entry }),\n      })\n    } catch {}\n    setGuestbookEntries((prev) => [entry, ...prev])\n    setGuestbookName(\"\")\n    setGuestbookMessage(\"\")\n    setShowGuestbookForm(false)\n  }, [guestbookName, guestbookMessage])\n\n  const formatWeddingDate = useCallback(() => {\n    if (!data.weddingDate) return \"\"\n    const d = new Date(data.weddingDate)\n    return `${d.getFullYear()}.${String(d.getMonth() + 1).padStart(2, \"0\")}.${String(d.getDate()).padStart(2, \"0\")}`\n  }, [data.weddingDate])\n\n  const formatWeddingTime = useCallback(() => {\n    if (!data.time) return \"\"\n    return data.time\n  }, [data.time])\n\n  const getMonthAbbr = useCallback(() => {\n    if (!data.weddingDate) return \"\"\n    const months = [\"JAN\", \"FEB\", \"MAR\", \"APR\", \"MAY\", \"JUN\", \"JUL\", \"AUG\", \"SEP\", \"OCT\", \"NOV\", \"DEC\"]\n    return months[new Date(data.weddingDate).getMonth()]\n  }, [data.weddingDate])\n\n  const getDayNum = useCallback(() => {\n    if (!data.weddingDate) return \"\"\n    return String(new Date(data.weddingDate).getDate())\n  }, [data.weddingDate])\n\n  const getCalendarData = useCallback(() => {\n    if (!data.weddingDate) return null\n    const d = new Date(data.weddingDate)\n    const year = d.getFullYear()\n    const month = d.getMonth()\n    const weddingDay = d.getDate()\n    const firstDay = new Date(year, month, 1).getDay()\n    const lastDate = new Date(year, month + 1, 0).getDate()\n    const days: (number | null)[] = []\n    for (let i = 0; i < firstDay; i++) days.push(null)\n    for (let i = 1; i <= lastDate; i++) days.push(i)\n    const dayNames = [\"일\", \"월\", \"화\", \"수\", \"목\", \"금\", \"토\"]\n    const weddingDayName = dayNames[d.getDay()]\n    return { year, month: month + 1, weddingDay, days, weddingDayName, dayNames }\n  }, [data.weddingDate])\n\n  const state: PreviewState = {\n    allPhotos,\n    galleryImages,\n    currentSlide,\n    countdown,\n    showContact,\n    setShowContact,\n    showPhotoViewer,\n    setShowPhotoViewer,\n    viewerIndex,\n    setViewerIndex,\n    showGuestbookForm,\n    setShowGuestbookForm,\n    guestbookName,\n    setGuestbookName,\n    guestbookMessage,\n    setGuestbookMessage,\n    guestbookEntries,\n    copiedToast,\n    expandedAccordion,\n    setExpandedAccordion,\n  }\n\n  const helpers: PreviewHelpers = {\n    formatWeddingDate,\n    formatWeddingTime,\n    getMonthAbbr,\n    getDayNum,\n    getCalendarData,\n    copyToClipboard,\n    copyLink,\n    submitGuestbook,\n  }\n\n  return { state, helpers }\n}\n"],"names":[],"mappings":"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"}}]
}