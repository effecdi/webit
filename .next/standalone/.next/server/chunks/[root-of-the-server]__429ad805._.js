module.exports=[36093,e=>{"use strict";let t,r,n,o,a,s;function i(e,t){if(null==e)return!1;try{return e instanceof t||Object.getPrototypeOf(e)[Symbol.toStringTag]===t.prototype[Symbol.toStringTag]}catch{return!1}}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(t="oauth4webapi/v3.8.3");let c="ERR_INVALID_ARG_VALUE",u="ERR_INVALID_ARG_TYPE";function d(e,t,r){let n=TypeError(e,{cause:r});return Object.assign(n,{code:t}),n}let l=Symbol(),p=Symbol(),f=Symbol(),h=Symbol();Symbol();let m=Symbol();Symbol();let y=new TextEncoder,b=new TextDecoder;function g(e){return"string"==typeof e?y.encode(e):b.decode(e)}function _(e){return"string"==typeof e?n(e):r(e)}r=Uint8Array.prototype.toBase64?e=>(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e.toBase64({alphabet:"base64url",omitPadding:!0})):e=>{e instanceof ArrayBuffer&&(e=new Uint8Array(e));let t=[];for(let r=0;r<e.byteLength;r+=32768)t.push(String.fromCharCode.apply(null,e.subarray(r,r+32768)));return btoa(t.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},n=Uint8Array.fromBase64?e=>{try{return Uint8Array.fromBase64(e,{alphabet:"base64url"})}catch(e){throw d("The input to be decoded is not correctly encoded.",c,e)}}:e=>{try{let t=atob(e.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}catch(e){throw d("The input to be decoded is not correctly encoded.",c,e)}};class w extends Error{code;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=eE,Error.captureStackTrace?.(this,this.constructor)}}class E extends Error{code;constructor(e,t){super(e,t),this.name=this.constructor.name,t?.code&&(this.code=t?.code),Error.captureStackTrace?.(this,this.constructor)}}function R(e,t,r){return new E(e,{code:t,cause:r})}function v(e){return!(null===e||"object"!=typeof e||Array.isArray(e))}function T(e){i(e,Headers)&&(e=Object.fromEntries(e.entries()));let r=new Headers(e??{});if(t&&!r.has("user-agent")&&r.set("user-agent",t),r.has("authorization"))throw d('"options.headers" must not include the "authorization" header name',c);return r}function S(e,t){if(void 0!==t){if("function"==typeof t&&(t=t(e.href)),!(t instanceof AbortSignal))throw d('"options.signal" must return or be an instance of AbortSignal',u);return t}}function O(e){return e.includes("//")?e.replace("//","/"):e}async function k(e,t,r,n){if(!(e instanceof URL))throw d(`"${t}" must be an instance of URL`,u);W(e,n?.[l]!==!0);let o=r(new URL(e.href)),a=T(n?.headers);return a.set("accept","application/json"),(n?.[h]||fetch)(o.href,{body:void 0,headers:Object.fromEntries(a.entries()),method:"GET",redirect:"manual",signal:S(o,n?.signal)})}async function x(e,t){return k(e,"issuerIdentifier",e=>{switch(t?.algorithm){case void 0:case"oidc":e.pathname=O(`${e.pathname}/.well-known/openid-configuration`);break;case"oauth2":!function(e,t,r=!1){"/"===e.pathname?e.pathname=t:e.pathname=O(`${t}/${r?e.pathname:e.pathname.replace(/(\/)$/,"")}`)}(e,".well-known/oauth-authorization-server");break;default:throw d('"options.algorithm" must be "oidc" (default), or "oauth2"',c)}return e},t)}function A(e,t,r,n,o){try{if("number"!=typeof e||!Number.isFinite(e))throw d(`${r} must be a number`,u,o);if(e>0)return;if(t){if(0!==e)throw d(`${r} must be a non-negative number`,c,o);return}throw d(`${r} must be a positive number`,c,o)}catch(e){if(n)throw R(e.message,n,o);throw e}}function P(e,t,r,n){try{if("string"!=typeof e)throw d(`${t} must be a string`,u,n);if(0===e.length)throw d(`${t} must not be empty`,c,n)}catch(e){if(r)throw R(e.message,r,n);throw e}}async function C(e,t){if(!(e instanceof URL)&&e!==eJ)throw d('"expectedIssuerIdentifier" must be an instance of URL',u);if(!i(t,Response))throw d('"response" must be an instance of Response',u);if(200!==t.status)throw R('"response" is not a conform Authorization Server Metadata response (unexpected HTTP status code)',eO,t);eU(t);let r=await eq(t);if(P(r.issuer,'"response" body "issuer" property',eT,{body:r}),e!==eJ&&new URL(r.issuer).href!==e.href)throw R('"response" body "issuer" property does not match the expected value',eC,{expected:e.href,body:r,attribute:"issuer"});return r}function j(e){var t=e,r="application/json";if(ee(t)!==r)throw function(e,...t){let r='"response" content-type must be ';if(t.length>2){let e=t.pop();r+=`${t.join(", ")}, or ${e}`}else 2===t.length?r+=`${t[0]} or ${t[1]}`:r+=t[0];return R(r,eS,e)}(t,r)}async function D(e){return P(e,"codeVerifier"),_(await crypto.subtle.digest("SHA-256",g(e)))}function U(e){let t=e?.[p];return"number"==typeof t&&Number.isFinite(t)?t:0}function I(e){let t=e?.[f];return"number"==typeof t&&Number.isFinite(t)&&-1!==Math.sign(t)?t:30}function N(){return Math.floor(Date.now()/1e3)}function L(e){if("object"!=typeof e||null===e)throw d('"as" must be an object',u);P(e.issuer,'"as.issuer"')}function M(e){if("object"!=typeof e||null===e)throw d('"client" must be an object',u);P(e.client_id,'"client.client_id"')}function $(e){return P(e,'"clientSecret"'),(t,r,n,o)=>{n.set("client_id",r.client_id),n.set("client_secret",e)}}let H=URL.parse?(e,t)=>URL.parse(e,t):(e,t)=>{try{return new URL(e,t)}catch{return null}};function W(e,t){if(t&&"https:"!==e.protocol)throw R("only requests to HTTPS are allowed",ek,e);if("https:"!==e.protocol&&"http:"!==e.protocol)throw R("only HTTP and HTTPS requests are allowed",ex,e)}function q(e,t,r,n){let o;if("string"!=typeof e||!(o=H(e)))throw R(`authorization server metadata does not contain a valid ${r?`"as.mtls_endpoint_aliases.${t}"`:`"as.${t}"`}`,void 0===e?ej:eD,{attribute:r?`mtls_endpoint_aliases.${t}`:t});return W(o,n),o}function J(e,t,r,n){return r&&e.mtls_endpoint_aliases&&t in e.mtls_endpoint_aliases?q(e.mtls_endpoint_aliases[t],t,r,n):q(e[t],t,r,n)}class z extends Error{cause;code;error;status;error_description;response;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=ew,this.cause=t.cause,this.error=t.cause.error,this.status=t.response.status,this.error_description=t.cause.error_description,Object.defineProperty(this,"response",{enumerable:!1,value:t.response}),Error.captureStackTrace?.(this,this.constructor)}}class G extends Error{cause;code;error;error_description;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=eR,this.cause=t.cause,this.error=t.cause.get("error"),this.error_description=t.cause.get("error_description")??void 0,Error.captureStackTrace?.(this,this.constructor)}}class B extends Error{cause;code;response;status;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=e_,this.cause=t.cause,this.status=t.response.status,this.response=t.response,Object.defineProperty(this,"response",{enumerable:!1}),Error.captureStackTrace?.(this,this.constructor)}}let X="[a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+",V=RegExp("^[,\\s]*("+X+")"),F=RegExp("^[,\\s]*("+X+')\\s*=\\s*"((?:[^"\\\\]|\\\\[\\s\\S])*)"[,\\s]*(.*)'),K=RegExp("^[,\\s]*"+("("+X+")\\s*=\\s*(")+X+")[,\\s]*(.*)"),Y=RegExp("^([a-zA-Z0-9\\-\\._\\~\\+\\/]+={0,2})(?:$|[,\\s])(.*)");async function Z(e){if(e.status>399&&e.status<500){eU(e),j(e);try{let t=await e.clone().json();if(v(t)&&"string"==typeof t.error&&t.error.length)return t}catch{}}}async function Q(e,t,r){if(e.status!==t){let t;if(function(e){let t;if(t=function(e){if(!i(e,Response))throw d('"response" must be an instance of Response',u);let t=e.headers.get("www-authenticate");if(null===t)return;let r=[],n=t;for(;n;){let e,t=n.match(V),o=t?.["1"].toLowerCase();if(!o)return;let a=n.substring(t[0].length);if(a&&!a.match(/^[\s,]/))return;let s=a.match(/^\s+(.*)$/),i=!!s;n=s?s[1]:void 0;let c={};if(i)for(;n;){let r,o;if(t=n.match(F)){if([,r,o,n]=t,o.includes("\\"))try{o=JSON.parse(`"${o}"`)}catch{}c[r.toLowerCase()]=o;continue}if(t=n.match(K)){[,r,o,n]=t,c[r.toLowerCase()]=o;continue}if(t=n.match(Y)){if(Object.keys(c).length)break;[,e,n]=t;break}return}else n=a||void 0;let u={scheme:o,parameters:c};e&&(u.token68=e),r.push(u)}if(r.length)return r}(e))throw new B("server responded with a challenge in the WWW-Authenticate HTTP Header",{cause:t,response:e})}(e),t=await Z(e))throw await e.body?.cancel(),new z("server responded with an error in the response body",{cause:t,response:e});throw R(`"response" is not a conform ${r} response (unexpected HTTP status code)`,eO,e)}}function ee(e){return e.headers.get("content-type")?.split(";")[0]}async function et(e,t,r,n,o,a,s){return await r(e,t,o,a),a.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(s?.[h]||fetch)(n.href,{body:o,headers:Object.fromEntries(a.entries()),method:"POST",redirect:"manual",signal:S(n,s?.signal)})}async function er(e,t,r,n,o,a){let s=J(e,"token_endpoint",t.use_mtls_endpoint_aliases,a?.[l]!==!0);o.set("grant_type",n);let i=T(a?.headers);if(i.set("accept","application/json"),a?.DPoP!==void 0){var u=a.DPoP;if(!eu.has(u))throw d('"options.DPoP" is not a valid DPoPHandle',c);await a.DPoP.addProof(s,i,"POST")}let p=await et(e,t,r,s,o,i,a);return a?.DPoP?.cacheNonce(p,s),p}Symbol();let en=new WeakMap,eo=new WeakMap;function ea(e){if(!e.id_token)return;let t=en.get(e);if(!t)throw d('"ref" was already garbage collected or did not resolve from the proper sources',c);return t}async function es(e,t,r,n,o,a){if(L(e),M(t),!i(r,Response))throw d('"response" must be an instance of Response',u);await Q(r,200,"Token Endpoint"),eU(r);let s=await eq(r);if(P(s.access_token,'"response" body "access_token" property',eT,{body:s}),P(s.token_type,'"response" body "token_type" property',eT,{body:s}),s.token_type=s.token_type.toLowerCase(),void 0!==s.expires_in){let e="number"!=typeof s.expires_in?parseFloat(s.expires_in):s.expires_in;A(e,!0,'"response" body "expires_in" property',eT,{body:s}),s.expires_in=e}if(void 0!==s.refresh_token&&P(s.refresh_token,'"response" body "refresh_token" property',eT,{body:s}),void 0!==s.scope&&"string"!=typeof s.scope)throw R('"response" body "scope" property must be a string',eT,{body:s});if(void 0!==s.id_token){P(s.id_token,'"response" body "id_token" property',eT,{body:s});let a=["aud","exp","iat","iss","sub"];!0===t.require_auth_time&&a.push("auth_time"),void 0!==t.default_max_age&&(A(t.default_max_age,!0,'"client.default_max_age"'),a.push("auth_time")),n?.length&&a.push(...n);let{claims:i,jwt:c}=await eI(s.id_token,eM.bind(void 0,t.id_token_signed_response_alg,e.id_token_signing_alg_values_supported,"RS256"),U(t),I(t),o).then(ef.bind(void 0,a)).then(ec.bind(void 0,e)).then(ei.bind(void 0,t.client_id));if(Array.isArray(i.aud)&&1!==i.aud.length){if(void 0===i.azp)throw R('ID Token "aud" (audience) claim includes additional untrusted audiences',eP,{claims:i,claim:"aud"});if(i.azp!==t.client_id)throw R('unexpected ID Token "azp" (authorized party) claim value',eP,{expected:t.client_id,claims:i,claim:"azp"})}void 0!==i.auth_time&&A(i.auth_time,!0,'ID Token "auth_time" (authentication time)',eT,{claims:i}),eo.set(r,c),en.set(s,i)}if(a?.[s.token_type]!==void 0)a[s.token_type](r,s);else if("dpop"!==s.token_type&&"bearer"!==s.token_type)throw new w("unsupported `token_type` value",{cause:{body:s}});return s}function ei(e,t){if(Array.isArray(t.claims.aud)){if(!t.claims.aud.includes(e))throw R('unexpected JWT "aud" (audience) claim value',eP,{expected:e,claims:t.claims,claim:"aud"})}else if(t.claims.aud!==e)throw R('unexpected JWT "aud" (audience) claim value',eP,{expected:e,claims:t.claims,claim:"aud"});return t}function ec(e,t){let r=e[ez]?.(t)??e.issuer;if(t.claims.iss!==r)throw R('unexpected JWT "iss" (issuer) claim value',eP,{expected:r,claims:t.claims,claim:"iss"});return t}let eu=new WeakSet,ed=Symbol();async function el(e,t,r,n,o,a,s){if(L(e),M(t),!eu.has(n))throw d('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()',c);P(o,'"redirectUri"');let i=e$(n,"code");if(!i)throw R('no authorization code in "callbackParameters"',eT);let u=new URLSearchParams(s?.additionalParameters);return u.set("redirect_uri",o),u.set("code",i),a!==ed&&(P(a,'"codeVerifier"'),u.set("code_verifier",a)),er(e,t,r,"authorization_code",u,s)}let ep={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation",auth_time:"authentication time"};function ef(e,t){for(let r of e)if(void 0===t.claims[r])throw R(`JWT "${r}" (${ep[r]}) claim missing`,eT,{claims:t.claims});return t}let eh=Symbol(),em=Symbol();async function ey(e,t,r,n){return"string"==typeof n?.expectedNonce||"number"==typeof n?.maxAge||n?.requireIdToken?eb(e,t,r,n.expectedNonce,n.maxAge,n[m],n.recognizedTokenTypes):eg(e,t,r,n?.[m],n?.recognizedTokenTypes)}async function eb(e,t,r,n,o,a,s){let i=[];switch(n){case void 0:n=eh;break;case eh:break;default:P(n,'"expectedNonce" argument'),i.push("nonce")}switch(o??=t.default_max_age){case void 0:o=em;break;case em:break;default:A(o,!0,'"maxAge" argument'),i.push("auth_time")}let c=await es(e,t,r,i,a,s);P(c.id_token,'"response" body "id_token" property',eT,{body:c});let u=ea(c);if(o!==em){let e=N()+U(t),r=I(t);if(u.auth_time+o<e-r)throw R("too much time has elapsed since the last End-User authentication",eA,{claims:u,now:e,tolerance:r,claim:"auth_time"})}if(n===eh){if(void 0!==u.nonce)throw R('unexpected ID Token "nonce" claim value',eP,{expected:void 0,claims:u,claim:"nonce"})}else if(u.nonce!==n)throw R('unexpected ID Token "nonce" claim value',eP,{expected:n,claims:u,claim:"nonce"});return c}async function eg(e,t,r,n,o){let a=await es(e,t,r,void 0,n,o),s=ea(a);if(s){if(void 0!==t.default_max_age){A(t.default_max_age,!0,'"client.default_max_age"');let e=N()+U(t),r=I(t);if(s.auth_time+t.default_max_age<e-r)throw R("too much time has elapsed since the last End-User authentication",eA,{claims:s,now:e,tolerance:r,claim:"auth_time"})}if(void 0!==s.nonce)throw R('unexpected ID Token "nonce" claim value',eP,{expected:void 0,claims:s,claim:"nonce"})}return a}let e_="OAUTH_WWW_AUTHENTICATE_CHALLENGE",ew="OAUTH_RESPONSE_BODY_ERROR",eE="OAUTH_UNSUPPORTED_OPERATION",eR="OAUTH_AUTHORIZATION_RESPONSE_ERROR",ev="OAUTH_PARSE_ERROR",eT="OAUTH_INVALID_RESPONSE",eS="OAUTH_RESPONSE_IS_NOT_JSON",eO="OAUTH_RESPONSE_IS_NOT_CONFORM",ek="OAUTH_HTTP_REQUEST_FORBIDDEN",ex="OAUTH_REQUEST_PROTOCOL_FORBIDDEN",eA="OAUTH_JWT_TIMESTAMP_CHECK_FAILED",eP="OAUTH_JWT_CLAIM_COMPARISON_FAILED",eC="OAUTH_JSON_ATTRIBUTE_COMPARISON_FAILED",ej="OAUTH_MISSING_SERVER_METADATA",eD="OAUTH_INVALID_SERVER_METADATA";function eU(e){if(e.bodyUsed)throw d('"response" body has been used already',c)}async function eI(e,t,r,n,o){let a,s,{0:i,1:c,length:u}=e.split(".");if(5===u)if(void 0!==o)e=await o(e),{0:i,1:c,length:u}=e.split(".");else throw new w("JWE decryption is not configured",{cause:e});if(3!==u)throw R("Invalid JWT",eT,e);try{a=JSON.parse(g(_(i)))}catch(e){throw R("failed to parse JWT Header body as base64url encoded JSON",ev,e)}if(!v(a))throw R("JWT Header must be a top level object",eT,e);if(t(a),void 0!==a.crit)throw new w('no JWT "crit" header parameter extensions are supported',{cause:{header:a}});try{s=JSON.parse(g(_(c)))}catch(e){throw R("failed to parse JWT Payload body as base64url encoded JSON",ev,e)}if(!v(s))throw R("JWT Payload must be a top level object",eT,e);let d=N()+r;if(void 0!==s.exp){if("number"!=typeof s.exp)throw R('unexpected JWT "exp" (expiration time) claim type',eT,{claims:s});if(s.exp<=d-n)throw R('unexpected JWT "exp" (expiration time) claim value, expiration is past current timestamp',eA,{claims:s,now:d,tolerance:n,claim:"exp"})}if(void 0!==s.iat&&"number"!=typeof s.iat)throw R('unexpected JWT "iat" (issued at) claim type',eT,{claims:s});if(void 0!==s.iss&&"string"!=typeof s.iss)throw R('unexpected JWT "iss" (issuer) claim type',eT,{claims:s});if(void 0!==s.nbf){if("number"!=typeof s.nbf)throw R('unexpected JWT "nbf" (not before) claim type',eT,{claims:s});if(s.nbf>d+n)throw R('unexpected JWT "nbf" (not before) claim value',eA,{claims:s,now:d,tolerance:n,claim:"nbf"})}if(void 0!==s.aud&&"string"!=typeof s.aud&&!Array.isArray(s.aud))throw R('unexpected JWT "aud" (audience) claim type',eT,{claims:s});return{header:a,claims:s,jwt:e}}async function eN(e){if(e.bodyUsed)throw d("form_post Request instances must contain a readable body",c,{cause:e});return e.text()}async function eL(e){if("POST"!==e.method)throw d("form_post responses are expected to use the POST method",c,{cause:e});if("application/x-www-form-urlencoded"!==ee(e))throw d("form_post responses are expected to use the application/x-www-form-urlencoded content-type",c,{cause:e});return eN(e)}function eM(e,t,r,n){if(void 0!==e){if("string"==typeof e?n.alg!==e:!e.includes(n.alg))throw R('unexpected JWT "alg" header parameter',eT,{header:n,expected:e,reason:"client configuration"});return}if(Array.isArray(t)){if(!t.includes(n.alg))throw R('unexpected JWT "alg" header parameter',eT,{header:n,expected:t,reason:"authorization server metadata"});return}if(void 0!==r){if("string"==typeof r?n.alg!==r:"function"==typeof r?!r(n.alg):!r.includes(n.alg))throw R('unexpected JWT "alg" header parameter',eT,{header:n,expected:r,reason:"default value"});return}throw R('missing client or server configuration to verify used JWT "alg" header parameter',void 0,{client:e,issuer:t,fallback:r})}function e$(e,t){let{0:r,length:n}=e.getAll(t);if(n>1)throw R(`"${t}" parameter must be provided only once`,eT);return r}let eH=Symbol(),eW=Symbol();async function eq(e,t=j){let r;try{r=await e.json()}catch(r){throw t(e),R('failed to parse "response" body as JSON',ev,r)}if(!v(r))throw R('"response" body must be a top level object',eT,{body:r});return r}let eJ=Symbol(),ez=Symbol();new TextEncoder,new TextDecoder;class eG extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(e,t){super(e,t),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class eB extends eG{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t)}}"undefined"!=typeof navigator&&navigator.userAgent?.startsWith?.("Mozilla/5.0 ")||(o={"user-agent":"openid-client/v6.8.1"});let eX="ERR_INVALID_ARG_VALUE",eV="ERR_INVALID_ARG_TYPE";function eF(e,t,r){let n=TypeError(e,{cause:r});return Object.assign(n,{code:t}),n}function eK(e){return D(e)}function eY(){return _(crypto.getRandomValues(new Uint8Array(32)))}class eZ extends Error{code;constructor(e,t){super(e,t),this.name=this.constructor.name,this.code=t?.code,Error.captureStackTrace?.(this,this.constructor)}}function eQ(e,t,r){return new eZ(e,{cause:t,code:r})}function e0(e){if(e instanceof TypeError||e instanceof eZ||e instanceof z||e instanceof G||e instanceof B)throw e;if(e instanceof E)switch(e.code){case ek:throw eQ("only requests to HTTPS are allowed",e,e.code);case ex:throw eQ("only requests to HTTP or HTTPS are allowed",e,e.code);case eO:throw eQ("unexpected HTTP response status code",e.cause,e.code);case eS:throw eQ("unexpected response content-type",e.cause,e.code);case ev:throw eQ("parsing error occured",e,e.code);case eT:throw eQ("invalid response encountered",e,e.code);case eP:throw eQ("unexpected JWT claim value encountered",e,e.code);case eC:throw eQ("unexpected JSON attribute value encountered",e,e.code);case eA:throw eQ("JWT timestamp claim value failed validation",e,e.code);default:throw eQ(e.message,e,e.code)}if(e instanceof w)throw eQ("unsupported operation",e,e.code);if(e instanceof DOMException)switch(e.name){case"OperationError":throw eQ("runtime operation error",e,eE);case"NotSupportedError":throw eQ("runtime unsupported operation",e,eE);case"TimeoutError":throw eQ("operation timed out",e,"OAUTH_TIMEOUT");case"AbortError":throw eQ("operation aborted",e,"OAUTH_ABORT")}throw new eZ("something went wrong",{cause:e})}async function e1(e,t,r,n,o){let s=new e2(await e3(e,o),t,r,n),i=a.get(s);if(o?.[h]&&(i.fetch=o[h]),o?.timeout&&(i.timeout=o.timeout),o?.execute)for(let e of o.execute)e(s);return s}async function e3(e,t){if(!(e instanceof URL))throw eF('"server" must be an instance of URL',eV);let r=!e.href.includes("/.well-known/"),n=t?.timeout??30,a=AbortSignal.timeout(1e3*n),s=await (r?x(e,{algorithm:t?.algorithm,[h]:t?.[h],[l]:t?.execute?.includes(e6),signal:a,headers:new Headers(o)}):(t?.[h]||fetch)((W(e,!t?.execute?.includes(e6)),e.href),{headers:Object.fromEntries(new Headers({accept:"application/json",...o}).entries()),body:void 0,method:"GET",redirect:"manual",signal:a})).then(e=>C(eJ,e)).catch(e0);return r&&new URL(s.issuer).href!==e.href&&(!("https://login.microsoftonline.com"!==e.origin||t?.algorithm&&"oidc"!==t.algorithm)&&(s[e5]=!0,1)||!(!e.hostname.endsWith(".b2clogin.com")||t?.algorithm&&"oidc"!==t.algorithm)||0||(()=>{throw new eZ("discovered metadata issuer does not match the expected issuer",{code:eC,cause:{expected:e.href,body:s,attribute:"issuer"}})})()),s}new TextDecoder;let e5=Symbol();class e2{constructor(e,t,r,n){let o;if("string"!=typeof t||!t.length)throw eF('"clientId" must be a non-empty string',eV);if("string"==typeof r&&(r={client_secret:r}),r?.client_id!==void 0&&t!==r.client_id)throw eF('"clientId" and "metadata.client_id" must be the same',eX);const i={...structuredClone(r),client_id:t};i[p]=r?.[p]??0,i[f]=r?.[f]??30,o=n||("string"==typeof i.client_secret&&i.client_secret.length?function(e){return void 0!==e?$(e):(s||=new WeakMap,(e,t,r,n)=>{let o;return(o=s.get(t))||(function(e,t){if("string"!=typeof e)throw eF(`${t} must be a string`,eV);if(0===e.length)throw eF(`${t} must not be empty`,eX)}(t.client_secret,'"metadata.client_secret"'),o=$(t.client_secret),s.set(t,o)),o(e,t,r,n)})}(i.client_secret):(e,t,r,n)=>{r.set("client_id",t.client_id)});let c=Object.freeze(i);const u=structuredClone(e);e5 in e&&(u[ez]=({claims:{tid:t}})=>e.issuer.replace("{tenantid}",t));let d=Object.freeze(u);(a||=new WeakMap).set(this,{__proto__:null,as:d,c,auth:o,tlsOnly:!0,jwksCache:{}})}serverMetadata(){let e=structuredClone(a.get(this).as);return Object.defineProperties(e,{supportsPKCE:{__proto__:null,value:(t="S256")=>e.code_challenge_methods_supported?.includes(t)===!0}}),e}clientMetadata(){return structuredClone(a.get(this).c)}get timeout(){return a.get(this).timeout}set timeout(e){a.get(this).timeout=e}get[h](){return a.get(this).fetch}set[h](e){a.get(this).fetch=e}}function e6(e){a.get(e).tlsOnly=!1}async function e8(e,t,r,n,s){var i,c,p,f,y;let b,g,_;if(e4(e),s?.flag!==e7&&!(t instanceof URL)&&!function(e,t){try{return Object.getPrototypeOf(e)[Symbol.toStringTag]===t}catch{return!1}}(t,"Request"))throw eF('"currentUrl" must be an instance of URL, or Request',eV);let{as:E,c:v,auth:T,fetch:S,tlsOnly:O,jarm:k,hybrid:x,nonRepudiation:A,timeout:C,decrypt:j,implicit:D}=a.get(e);if(s?.flag===e7)b=s.authResponse,g=s.redirectUri;else{if(!(t instanceof URL)){let e=t;switch(t=new URL(t.url),e.method){case"GET":break;case"POST":let r=new URLSearchParams(await eL(e));if(x)t.hash=r.toString();else for(let[e,n]of r.entries())t.searchParams.append(e,n);break;default:throw eF("unexpected Request HTTP method",eX)}}switch((i=new URL(i=t)).search="",i.hash="",g=i.href,!0){case!!k:b=await k(t,r?.expectedState);break;case!!x:b=await x(t,r?.expectedNonce,r?.expectedState,r?.maxAge);break;case!!D:throw TypeError("authorizationCodeGrant() cannot be used by response_type=id_token clients");default:try{b=function(e,t,r,n){var o;if(L(e),M(t),r instanceof URL&&(r=r.searchParams),!(r instanceof URLSearchParams))throw d('"parameters" must be an instance of URLSearchParams, or URL',u);if(e$(r,"response"))throw R('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()',eT,{parameters:r});let a=e$(r,"iss"),s=e$(r,"state");if(!a&&e.authorization_response_iss_parameter_supported)throw R('response parameter "iss" (issuer) missing',eT,{parameters:r});if(a&&a!==e.issuer)throw R('unexpected "iss" (issuer) response parameter value',eT,{expected:e.issuer,parameters:r});switch(n){case void 0:case eW:if(void 0!==s)throw R('unexpected "state" response parameter encountered',eT,{expected:void 0,parameters:r});break;case eH:break;default:if(P(n,'"expectedState" argument'),s!==n)throw R(void 0===s?'response parameter "state" missing':'unexpected "state" response parameter value',eT,{expected:n,parameters:r})}if(e$(r,"error"))throw new G("authorization response from the server is an error",{cause:r});let i=e$(r,"id_token"),c=e$(r,"token");if(void 0!==i||void 0!==c)throw new w("implicit and hybrid flows are not supported");return o=new URLSearchParams(r),eu.add(o),o}(E,v,t.searchParams,r?.expectedState)}catch(e){e0(e)}}}let U=await el(E,v,T,b,g,r?.pkceCodeVerifier||ed,{additionalParameters:n,[h]:S,[l]:!O,DPoP:s?.DPoP,headers:new Headers(o),signal:(p=C)?AbortSignal.timeout(1e3*p):void 0}).catch(e0);("string"==typeof r?.expectedNonce||"number"==typeof r?.maxAge)&&(r.idTokenExpected=!0);let I=ey(E,v,U,{expectedNonce:r?.expectedNonce,maxAge:r?.maxAge,requireIdToken:r?.idTokenExpected,[m]:j});try{_=await I}catch(t){if(f=t,y=s,y?.DPoP&&y.flag!==e7&&function(e){if(e instanceof B){let{0:t,length:r}=e.cause;return 1===r&&"dpop"===t.scheme&&"use_dpop_nonce"===t.parameters.error}return e instanceof z&&"use_dpop_nonce"===e.error}(f))return e8(e,void 0,r,n,{...s,flag:e7,authResponse:b,redirectUri:g});e0(t)}return _.id_token&&await A?.(U),Object.defineProperties(c=_,function(e){let t;if(void 0!==e.expires_in){let r=new Date;r.setSeconds(r.getSeconds()+e.expires_in),t=r.getTime()}return{expiresIn:{__proto__:null,value(){if(t){let e=Date.now();return t>e?Math.floor((t-e)/1e3):0}}},claims:{__proto__:null,value(){try{return ea(this)}catch{return}}}}}(c)),_}function e9(e,t){e4(e);let{as:r,c:n,tlsOnly:o,hybrid:s,jarm:i,implicit:c}=a.get(e),u=J(r,"authorization_endpoint",!1,o);if((t=new URLSearchParams(t)).has("client_id")||t.set("client_id",n.client_id),!t.has("request_uri")&&!t.has("request")){if(t.has("response_type")||t.set("response_type",s?"code id_token":c?"id_token":"code"),c&&!t.has("nonce"))throw eF("response_type=id_token clients must provide a nonce parameter in their authorization request parameters",eX);i&&t.set("response_mode","jwt")}for(let[e,r]of t.entries())u.searchParams.append(e,r);return u}function e4(e){if(!(e instanceof e2))throw eF('"config" must be an instance of Configuration',eV);if(Object.getPrototypeOf(e)!==e2.prototype)throw eF("subclassing Configuration is not allowed",eX)}Object.freeze(e2.prototype);let e7=Symbol();e.s(["allowInsecureRequests",()=>e6,"authorizationCodeGrant",()=>e8,"buildAuthorizationUrl",()=>e9,"calculatePKCECodeChallenge",()=>eK,"discovery",()=>e1,"randomPKCECodeVerifier",()=>eY],36093)},65102,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={MutableRequestCookiesAdapter:function(){return f},ReadonlyRequestCookiesError:function(){return c},RequestCookiesAdapter:function(){return u},appendMutableCookies:function(){return p},areCookiesMutableInCurrentPhase:function(){return m},createCookiesWithMutableAccessCheck:function(){return h},getModifiedCookieValues:function(){return l},responseCookiesToRequestCookies:function(){return b}};for(var o in n)Object.defineProperty(r,o,{enumerable:!0,get:n[o]});let a=e.r(2799),s=e.r(35592),i=e.r(56704);class c extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options")}static callable(){throw new c}}class u{static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"clear":case"delete":case"set":return c.callable;default:return s.ReflectAdapter.get(e,t,r)}}})}}let d=Symbol.for("next.mutated.cookies");function l(e){let t=e[d];return t&&Array.isArray(t)&&0!==t.length?t:[]}function p(e,t){let r=l(t);if(0===r.length)return!1;let n=new a.ResponseCookies(e),o=n.getAll();for(let e of r)n.set(e);for(let e of o)n.set(e);return!0}class f{static wrap(e,t){let r=new a.ResponseCookies(new Headers);for(let t of e.getAll())r.set(t);let n=[],o=new Set,c=()=>{let e=i.workAsyncStorage.getStore();if(e&&(e.pathWasRevalidated=!0),n=r.getAll().filter(e=>o.has(e.name)),t){let e=[];for(let t of n){let r=new a.ResponseCookies(new Headers);r.set(t),e.push(r.toString())}t(e)}},u=new Proxy(r,{get(e,t,r){switch(t){case d:return n;case"delete":return function(...t){o.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.delete(...t),u}finally{c()}};case"set":return function(...t){o.add("string"==typeof t[0]?t[0]:t[0].name);try{return e.set(...t),u}finally{c()}};default:return s.ReflectAdapter.get(e,t,r)}}});return u}}function h(e){let t=new Proxy(e.mutableCookies,{get(r,n,o){switch(n){case"delete":return function(...n){return y(e,"cookies().delete"),r.delete(...n),t};case"set":return function(...n){return y(e,"cookies().set"),r.set(...n),t};default:return s.ReflectAdapter.get(r,n,o)}}});return t}function m(e){return"action"===e.phase}function y(e,t){if(!m(e))throw new c}function b(e){let t=new a.RequestCookies(new Headers);for(let r of e.getAll())t.set(r);return t}},6097,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return c}});let n=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(void 0);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var i=a?Object.getOwnPropertyDescriptor(e,s):null;i&&(i.get||i.set)?Object.defineProperty(n,s,i):n[s]=e[s]}return n.default=e,r&&r.set(e,n),n}(e.r(37014));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}let a={current:null},s="function"==typeof n.cache?n.cache:e=>e,i=console.warn;function c(e){return function(...t){i(e(...t))}}s(e=>{try{i(a.current)}finally{a.current=null}})},56597,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"cookies",{enumerable:!0,get:function(){return f}});let n=e.r(65102),o=e.r(2799),a=e.r(56704),s=e.r(32319),i=e.r(17251),c=e.r(45143),u=e.r(57414),d=e.r(6097),l=e.r(93950),p=e.r(4462);function f(){let e="cookies",t=a.workAsyncStorage.getStore(),r=s.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,l.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`cookies()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E843",enumerable:!1,configurable:!0});if(t.forceStatic)return m(n.RequestCookiesAdapter.seal(new o.RequestCookies(new Headers({}))));if(t.dynamicShouldError)throw Object.defineProperty(new c.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`cookies()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E849",enumerable:!1,configurable:!0});if(r)switch(r.type){case"cache":let a=Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E831",enumerable:!1,configurable:!0});throw Error.captureStackTrace(a,f),t.invalidDynamicUsageError??=a,a;case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used \`cookies()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E846",enumerable:!1,configurable:!0});case"prerender":var d=t,y=r;let s=h.get(y);if(s)return s;let b=(0,u.makeHangingPromise)(y.renderSignal,d.route,"`cookies()`");return h.set(y,b),b;case"prerender-client":let g="`cookies`";throw Object.defineProperty(new p.InvariantError(`${g} must not be used within a Client Component. Next.js should be preventing ${g} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,i.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,i.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,i.delayUntilRuntimeStage)(r,m(r.cookies));case"private-cache":return m(r.cookies);case"request":return(0,i.trackDynamicDataInDynamicRender)(r),m((0,n.areCookiesMutableInCurrentPhase)(r)?r.userspaceMutableCookies:r.cookies)}}(0,s.throwForMissingRequestStore)(e)}e.r(88343);let h=new WeakMap;function m(e){let t=h.get(e);if(t)return t;let r=Promise.resolve(e);return h.set(e,r),r}(0,d.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`cookies()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E830",enumerable:!1,configurable:!0})})},98396,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={HeadersAdapter:function(){return i},ReadonlyHeadersError:function(){return s}};for(var o in n)Object.defineProperty(r,o,{enumerable:!0,get:n[o]});let a=e.r(35592);class s extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new s}}class i extends Headers{constructor(e){super(),this.headers=new Proxy(e,{get(t,r,n){if("symbol"==typeof r)return a.ReflectAdapter.get(t,r,n);let o=r.toLowerCase(),s=Object.keys(e).find(e=>e.toLowerCase()===o);if(void 0!==s)return a.ReflectAdapter.get(t,s,n)},set(t,r,n,o){if("symbol"==typeof r)return a.ReflectAdapter.set(t,r,n,o);let s=r.toLowerCase(),i=Object.keys(e).find(e=>e.toLowerCase()===s);return a.ReflectAdapter.set(t,i??r,n,o)},has(t,r){if("symbol"==typeof r)return a.ReflectAdapter.has(t,r);let n=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0!==o&&a.ReflectAdapter.has(t,o)},deleteProperty(t,r){if("symbol"==typeof r)return a.ReflectAdapter.deleteProperty(t,r);let n=r.toLowerCase(),o=Object.keys(e).find(e=>e.toLowerCase()===n);return void 0===o||a.ReflectAdapter.deleteProperty(t,o)}})}static seal(e){return new Proxy(e,{get(e,t,r){switch(t){case"append":case"delete":case"set":return s.callable;default:return a.ReflectAdapter.get(e,t,r)}}})}merge(e){return Array.isArray(e)?e.join(", "):e}static from(e){return e instanceof Headers?e:new i(e)}append(e,t){let r=this.headers[e];"string"==typeof r?this.headers[e]=[r,t]:Array.isArray(r)?r.push(t):this.headers[e]=t}delete(e){delete this.headers[e]}get(e){let t=this.headers[e];return void 0!==t?this.merge(t):null}has(e){return void 0!==this.headers[e]}set(e,t){this.headers[e]=t}forEach(e,t){for(let[r,n]of this.entries())e.call(t,n,r,this)}*entries(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase(),r=this.get(t);yield[t,r]}}*keys(){for(let e of Object.keys(this.headers)){let t=e.toLowerCase();yield t}}*values(){for(let e of Object.keys(this.headers)){let t=this.get(e);yield t}}[Symbol.iterator](){return this.entries()}}},35286,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"headers",{enumerable:!0,get:function(){return p}});let n=e.r(98396),o=e.r(56704),a=e.r(32319),s=e.r(17251),i=e.r(45143),c=e.r(57414),u=e.r(6097),d=e.r(93950),l=e.r(4462);function p(){let e="headers",t=o.workAsyncStorage.getStore(),r=a.workUnitAsyncStorage.getStore();if(t){if(r&&"after"===r.phase&&!(0,d.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`headers()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E839",enumerable:!1,configurable:!0});if(t.forceStatic)return h(n.HeadersAdapter.seal(new Headers({})));if(r)switch(r.type){case"cache":{let e=Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E833",enumerable:!1,configurable:!0});throw Error.captureStackTrace(e,p),t.invalidDynamicUsageError??=e,e}case"unstable-cache":throw Object.defineProperty(Error(`Route ${t.route} used \`headers()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E838",enumerable:!1,configurable:!0})}if(t.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${t.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E828",enumerable:!1,configurable:!0});if(r)switch(r.type){case"prerender":var u=t,m=r;let o=f.get(m);if(o)return o;let a=(0,c.makeHangingPromise)(m.renderSignal,u.route,"`headers()`");return f.set(m,a),a;case"prerender-client":let y="`headers`";throw Object.defineProperty(new l.InvariantError(`${y} must not be used within a client component. Next.js should be preventing ${y} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,s.postponeWithTracking)(t.route,e,r.dynamicTracking);case"prerender-legacy":return(0,s.throwToInterruptStaticGeneration)(e,t,r);case"prerender-runtime":return(0,s.delayUntilRuntimeStage)(r,h(r.headers));case"private-cache":return h(r.headers);case"request":return(0,s.trackDynamicDataInDynamicRender)(r),h(r.headers)}}(0,a.throwForMissingRequestStore)(e)}e.r(88343);let f=new WeakMap;function h(e){let t=f.get(e);if(t)return t;let r=Promise.resolve(e);return f.set(e,r),r}(0,u.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`headers()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E836",enumerable:!1,configurable:!0})})},70321,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"draftMode",{enumerable:!0,get:function(){return d}});let n=e.r(32319),o=e.r(56704),a=e.r(17251),s=e.r(6097),i=e.r(45143),c=e.r(4028),u=e.r(4462);function d(){let e=o.workAsyncStorage.getStore(),t=n.workUnitAsyncStorage.getStore();switch((!e||!t)&&(0,n.throwForMissingRequestStore)("draftMode"),t.type){case"prerender-runtime":return(0,a.delayUntilRuntimeStage)(t,l(t.draftMode,e));case"request":return l(t.draftMode,e);case"cache":case"private-cache":case"unstable-cache":let r=(0,n.getDraftModeProviderForCacheScope)(e,t);if(r)return l(r,e);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return l(null,e);default:return t}}function l(e,t){let r=f.get(e??p);return r||Promise.resolve(new h(e))}e.r(35592);let p={},f=new WeakMap;class h{constructor(e){this._provider=e}get isEnabled(){return null!==this._provider&&this._provider.isEnabled}enable(){m("draftMode().enable()",this.enable),null!==this._provider&&this._provider.enable()}disable(){m("draftMode().disable()",this.disable),null!==this._provider&&this._provider.disable()}}function m(e,t){let r=o.workAsyncStorage.getStore(),s=n.workUnitAsyncStorage.getStore();if(r){if((null==s?void 0:s.phase)==="after")throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside \`after()\`. The enabled status of \`draftMode()\` can be read inside \`after()\` but you cannot enable or disable \`draftMode()\`. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E845",enumerable:!1,configurable:!0});if(r.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${r.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(s)switch(s.type){case"cache":case"private-cache":{let n=Object.defineProperty(Error(`Route ${r.route} used "${e}" inside "use cache". The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E829",enumerable:!1,configurable:!0});throw Error.captureStackTrace(n,t),r.invalidDynamicUsageError??=n,n}case"unstable-cache":throw Object.defineProperty(Error(`Route ${r.route} used "${e}" inside a function cached with \`unstable_cache()\`. The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E844",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{let t=Object.defineProperty(Error(`Route ${r.route} used ${e} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,a.abortAndThrowOnSynchronousRequestDataAccess)(r.route,e,t,s)}case"prerender-client":let n="`draftMode`";throw Object.defineProperty(new u.InvariantError(`${n} must not be used within a Client Component. Next.js should be preventing ${n} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,a.postponeWithTracking)(r.route,e,s.dynamicTracking);case"prerender-legacy":s.revalidate=0;let o=Object.defineProperty(new c.DynamicServerError(`Route ${r.route} couldn't be rendered statically because it used \`${e}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw r.dynamicUsageDescription=e,r.dynamicUsageStack=o.stack,o;case"request":(0,a.trackDynamicDataInDynamicRender)(s)}}}(0,s.createDedupedByCallsiteServerErrorLoggerDev)(function(e,t){let r=e?`Route "${e}" `:"This route ";return Object.defineProperty(Error(`${r}used ${t}. \`draftMode()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E835",enumerable:!1,configurable:!0})})},70891,(e,t,r)=>{t.exports.cookies=e.r(56597).cookies,t.exports.headers=e.r(35286).headers,t.exports.draftMode=e.r(70321).draftMode},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},68105,e=>e.a(async(t,r)=>{try{var n=e.i(36093),o=e.i(77035),a=e.i(18612),s=e.i(75225),i=e.i(70891),c=e.i(54799),u=t([o]);[o]=u.then?(await u)():u;let b="weve_session",g=null;async function d(){if(g)return g;let e=process.env.ISSUER_URL||"https://replit.com/";return l(),g=await n.discovery(new URL(e),process.env.REPL_ID,void 0,void 0,{execute:[n.allowInsecureRequests]})}function l(){let e=process.env.REPLIT_DOMAINS?.split(",")[0]||process.env.REPLIT_DEV_DOMAIN;return`https://${e}/api/auth/callback`}async function p(){let e=await d(),t=l(),r=n.randomPKCECodeVerifier(),o=await n.calculatePKCECodeChallenge(r),a=c.default.randomBytes(16).toString("hex"),s=await (0,i.cookies)();return s.set("oidc_code_verifier",r,{httpOnly:!0,secure:!0,maxAge:600,path:"/",sameSite:"lax"}),s.set("oidc_state",a,{httpOnly:!0,secure:!0,maxAge:600,path:"/",sameSite:"lax"}),n.buildAuthorizationUrl(e,{redirect_uri:t,scope:"openid email profile",code_challenge:o,code_challenge_method:"S256",state:a}).href}async function f(e){try{let t=await d();l();let r=await (0,i.cookies)(),s=r.get("oidc_code_verifier")?.value,u=r.get("oidc_state")?.value;if(!s||!u)return{success:!1,error:"Missing OIDC session data"};let p=(await n.authorizationCodeGrant(t,e,{pkceCodeVerifier:s,expectedState:u})).claims();if(!p||!p.sub)return{success:!1,error:"No user claims in token"};let f={id:p.sub,email:p.email||null,firstName:p.first_name||p.given_name||null,lastName:p.last_name||p.family_name||null,profileImageUrl:p.profile_image_url||p.picture||null};await o.db.insert(a.users).values({...f,updatedAt:new Date}).onConflictDoUpdate({target:a.users.id,set:{email:f.email,firstName:f.firstName,lastName:f.lastName,profileImageUrl:f.profileImageUrl,updatedAt:new Date}});let h=c.default.randomBytes(32).toString("hex"),m=new Date(Date.now()+2592e6);return await o.db.insert(a.sessions).values({sid:h,sess:{userId:f.id,claims:f},expire:m}),r.set(b,h,{httpOnly:!0,secure:!0,maxAge:2592e3,path:"/",sameSite:"lax"}),r.delete("oidc_code_verifier"),r.delete("oidc_state"),{success:!0}}catch(e){return console.error("OIDC callback error:",e),{success:!1,error:String(e)}}}async function h(){try{let e=await (0,i.cookies)(),t=e.get(b)?.value;if(!t)return null;let r=await o.db.select().from(a.sessions).where((0,s.eq)(a.sessions.sid,t)).limit(1);if(0===r.length)return null;let n=r[0];if(new Date(n.expire)<new Date)return await o.db.delete(a.sessions).where((0,s.eq)(a.sessions.sid,t)),null;let c=n.sess,u=await o.db.select().from(a.users).where((0,s.eq)(a.users.id,c.userId)).limit(1);if(0===u.length)return null;let d=u[0];return{id:d.id,email:d.email,firstName:d.firstName,lastName:d.lastName,profileImageUrl:d.profileImageUrl}}catch(e){return console.error("getAuthUser error:",e),null}}async function m(){let e=await (0,i.cookies)(),t=e.get(b)?.value;t&&await o.db.delete(a.sessions).where((0,s.eq)(a.sessions.sid,t)),e.delete(b)}async function y(){let e=await h();return e?.id||null}e.s(["getAuthUser",()=>h,"getAuthUserId",()=>y,"handleCallback",()=>f,"logout",()=>m,"startLogin",()=>p]),r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__429ad805._.js.map